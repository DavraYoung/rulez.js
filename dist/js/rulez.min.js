/*! rulez.js 2015-02-15 */
var Rulez=function(a){"use strict";function b(a){return Math.floor(p/a.pixelGap)+1}function c(a,b,c){for(var d=a;b>d;d+=c.pixelGap){var f=e(d,c);c.renderer&&c.renderer(f),o.appendChild(f)}}function d(a,b,c){for(var d=[],e=a;b>e;e+=c.pixelGap){var f=h(e,c);o.appendChild(f),c.renderer&&c.renderer(f),d.push(f)}return d}function e(a,b){switch(b.type){case"line":return f(a,b);case"rect":return g(a,b);default:return g(a,b)}}function f(a,b){var c,d,e,f,g=document.createElementNS(l,"line");return j()?(c="y1",d="y2",e="x1",f="x2"):(c="x1",d="x2",e="y1",f="y2"),g.setAttribute("class",b.className),g.setAttribute(c,a),g.setAttribute(d,a),g.setAttribute(e,"0"),g.setAttribute(f,b.lineLength),g.setAttribute("stroke-width",b.strokeWidth),g}function g(a,b){var c,d,e,f,g=document.createElementNS(l,"rect");return j()?(c="y",d="x",e="width",f="height"):(c="x",d="y",e="height",f="width"),g.setAttribute("class",b.className),g.setAttribute(c,a),g.setAttribute(d,"0"),g.setAttribute(e,b.lineLength),g.setAttribute(f,b.strokeWidth),g}function h(a,b){var c,d,e,f=document.createElementNS(l,"text");return f.setAttribute("class",b.className),j()?(c="y",d="x",e="rotate("+b.rotation+" "+b.offset+" "+a+")"):(c="x",d="y",e="rotate("+b.rotation+" "+a+" "+b.offset+")"),f.setAttribute(c,a),f.setAttribute(d,b.offset),f.setAttribute("transform",e),f.textContent=a,f}function i(){return document.createElementNS(l,"g")}function j(){return"vertical"===n.layout}function k(a,b,c){if(!b)return a;for(var d in b)if(b.hasOwnProperty(d))switch(d){case"divisionDefaults":case"textDefaults":k(a[d],b[d]);break;default:c&&a[d]||(a[d]=b[d])}return a.divisions&&a.divisions.forEach(function(b){k(b,a.divisionDefaults,b),b.className||(b.className="line"===b.type?"rulez-line":"rulez-rect")}),a.texts&&a.texts.forEach(function(b){k(b,a.textDefaults,b)}),a}var l="http://www.w3.org/2000/svg",m={width:null,height:null,element:null,layout:"horizontal",divisionDefaults:{strokeWidth:1,type:"rect",className:"rulez-rect"},textDefaults:{rotation:0,offset:25,className:"rulez-text"},divisions:[{pixelGap:5,lineLength:5},{pixelGap:25,lineLength:10},{pixelGap:50,lineLength:15},{pixelGap:100,lineLength:20}],texts:[{pixelGap:100}]},n=k(JSON.parse(JSON.stringify(m)),a),o=i();n.width=n.width?n.width:n.element.clientWidth,n.height=n.height?n.height:n.element.clientHeight,n.element.appendChild(o);var p=0,q=0,r=[];this.render=function(){n.divisions.forEach(function(a){a.pixelGap>p&&(p=a.pixelGap)});var a=1,e=j()?n.height:n.width,f=q+e+p*a,g=q-q%p-p*a;n.divisions.forEach(function(a){c(g,f,a)}),n.texts.forEach(function(a){var c=b(a),f=q+e+a.pixelGap*c,g=q-q%a.pixelGap-a.pixelGap*c;r.push(d(g,f,a))})},this.scrollTo=function(a){q=a,j()?o.setAttribute("transform","matrix(1,0,0,1,0,"+-q%p+")"):o.setAttribute("transform","matrix(1,0,0,1,"+-q%p+",0)");for(var c=0;c<n.texts.length;c++)for(var d=n.texts[c],e=r[c],f=q%p,g=q-f,h=b(d),i=0;i<e.length;i++){var k=e[i];k.textContent=g+(i-h)*d.pixelGap}}};