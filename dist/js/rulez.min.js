/*! rulez.js 2015-02-16 */
var Rulez=function(a){"use strict";function b(){w||q.divisions.forEach(function(a){a.pixelGap>w&&(w=a.pixelGap)}),n=v-v%w+w*r,m=-w*r}function c(a,b){q.divisions.forEach(function(c){d(a,b,c)});var c=0;q.texts.forEach(function(d){var f=e(a,b,d);t[c]?t[c]=t[c].concat(f):t.push(f),c++})}function d(a,b,c){for(var d=a;b>d;d+=c.pixelGap){var e=f(d,c);c.renderer&&c.renderer(e),s.appendChild(e)}}function e(a,b,c){for(var d=[],e=a;b>e;e+=c.pixelGap){var f=i(e,c);s.appendChild(f),c.renderer&&c.renderer(f),d.push(f)}return d}function f(a,b){switch(b.type){case"line":return g(a,b);case"rect":return h(a,b);default:return h(a,b)}}function g(a,b){var c,d,e,f,g=document.createElementNS(o,"line");return k()?(c="y1",d="y2",e="x1",f="x2"):(c="x1",d="x2",e="y1",f="y2"),g.setAttribute("class",b.className),g.setAttribute(c,a),g.setAttribute(d,a),g.setAttribute(e,"0"),g.setAttribute(f,b.lineLength),g.setAttribute("stroke-width",b.strokeWidth),g}function h(a,b){var c,d,e,f,g=document.createElementNS(o,"rect");return k()?(c="y",d="x",e="width",f="height"):(c="x",d="y",e="height",f="width"),g.setAttribute("class",b.className),g.setAttribute(c,a),g.setAttribute(d,"0"),g.setAttribute(e,b.lineLength),g.setAttribute(f,b.strokeWidth),g}function i(a,b){var c,d,e,f=document.createElementNS(o,"text");return f.setAttribute("class",b.className),k()?(c="y",d="x",e="rotate("+b.rotation+" "+b.offset+" "+a+")"):(c="x",d="y",e="rotate("+b.rotation+" "+a+" "+b.offset+")"),f.setAttribute(c,a),f.setAttribute(d,b.offset),f.setAttribute("transform",e),f.textContent=a,f}function j(){return document.createElementNS(o,"g")}function k(){return"vertical"===q.layout}function l(a,b,c){if(!b)return a;for(var d in b)if(b.hasOwnProperty(d))switch(d){case"divisionDefaults":case"textDefaults":l(a[d],b[d]);break;default:c&&a[d]||(a[d]=b[d])}return a.divisions&&a.divisions.forEach(function(b){l(b,a.divisionDefaults,b),b.className||(b.className="line"===b.type?"rulez-line":"rulez-rect")}),a.texts&&a.texts.forEach(function(b){l(b,a.textDefaults,b)}),a}var m,n,o="http://www.w3.org/2000/svg",p={width:null,height:null,element:null,layout:"horizontal",divisionDefaults:{strokeWidth:1,type:"rect",className:"rulez-rect"},textDefaults:{rotation:0,offset:25,className:"rulez-text"},divisions:[{pixelGap:5,lineLength:5},{pixelGap:25,lineLength:10},{pixelGap:50,lineLength:15},{pixelGap:100,lineLength:20}],texts:[{pixelGap:100}]},q=l(JSON.parse(JSON.stringify(p)),a),r=2,s=j(),t=[],u=0;q.width=q.width?q.width:q.element.clientWidth,q.height=q.height?q.height:q.element.clientHeight,q.element.appendChild(s);var v=k()?q.height:q.width,w=0;this.render=function(){b(),c(m,n)},this.scrollTo=function(a){u=a,k()?s.setAttribute("transform","matrix(1,0,0,1,0,"+-u%w+")"):s.setAttribute("transform","matrix(1,0,0,1,"+-u%w+",0)");for(var b=0;b<q.texts.length;b++)for(var c=q.texts[b],d=t[b],e=u%w,f=u-e,g=0;g<d.length;g++){var h=d[g];h.textContent=f+(g-r)*c.pixelGap}},this.resize=function(){var a=v,d=k()?q.element.clientHeight:q.element.clientWidth;if(a!==d)if(a>d);else{v=d;var e=n;b(),c(e,n),this.scrollTo(u)}}};