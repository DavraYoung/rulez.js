/*! rulez.js 2016-08-26 */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("rulez.js requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=function(b){"use strict";function c(b){var d,e=b.cloneNode(!1);if(b instanceof Element){var f=a.getComputedStyle(b);if(f)for(d=0;d<f.length;d++){var g=f[d];e.style.setProperty(g,f.getPropertyValue(g),"")}}for(d=0;d<b.childNodes.length;d++)e.appendChild(c(b.childNodes[d]));return e}function d(){F||y.divisions.forEach(function(a){a.pixelGap>F&&(F=a.pixelGap)}),v=E-E%F+F*z,u=-F*z}function e(a,b){y.divisions.forEach(function(c){f(a,b,c)});var c=0;y.texts.forEach(function(d){var e=g(a,b,d);B[c]?B[c]=B[c].concat(e):B.push(e),c++})}function f(a,b,c){for(var d=a;d<b;d+=c.pixelGap){var e=h(d,c);A.appendChild(e),c.renderer&&c.renderer(e)}}function g(a,b,c){for(var d=[],e=a;e<b;e+=c.pixelGap){var f=k(e,c);A.appendChild(f),c.renderer&&c.renderer(f),d.push(f)}return d}function h(a,b){switch(b.type){case"line":return i(a,b);case"rect":return j(a,b);default:return j(a,b)}}function i(b,c){var d,e,f,g,h=a.document.createElementNS(w,"line"),i=n();return m()?(d="y1",e="y2",f="x1",g="x2"):(d="x1",e="x2",f="y1",g="y2"),h.setAttribute("class",c.className),h.setAttribute(d,q(b)),h.setAttribute(e,q(b)),h.setAttribute(f,q(i?"0":o()-c.lineLength)),h.setAttribute(g,q(i?c.lineLength:o())),h.setAttribute("stroke-width",q(c.strokeWidth)),h}function j(b,c){var d,e,f,g,h=a.document.createElementNS(w,"rect"),i=n();return m()?(d="y",e="x",f="width",g="height"):(d="x",e="y",f="height",g="width"),h.setAttribute("class",c.className),h.setAttribute(d,q(b)),h.setAttribute(e,q(i?"0":o()-c.lineLength)),h.setAttribute(f,q(c.lineLength)),h.setAttribute(g,q(c.strokeWidth)),h}function k(b,c){var d,e,f=a.document.createElementNS(w,"text"),g=t(c);return f.setAttribute("class",c.className),m()?(d="y",e="x"):(d="x",e="y"),f.origPos=b,f.origPosAttribute=d,f.setAttribute(d,q(b)),f.setAttribute(e,q(g)),s(f,c),f.textContent=c.showUnits?q(b):b,c.centerText&&f.setAttribute("text-anchor","middle"),f}function l(){return a.document.createElementNS(w,"g")}function m(){return"vertical"===y.layout}function n(){return!("bottom"===y.alignment||"right"===y.alignment)}function o(){return m()?y.width:y.height}function p(a,b,c){if(!b)return a;for(var d in b)if(b.hasOwnProperty(d))switch(d){case"divisionDefaults":case"textDefaults":p(a[d],b[d]);break;default:c&&a[d]||(a[d]=b[d])}return a.divisions&&a.divisions.forEach(function(b){p(b,a.divisionDefaults,b),b.className||(b.className="line"===b.type?"rulez-line":"rulez-rect")}),a.texts&&a.texts.forEach(function(b){p(b,a.textDefaults,b)}),a}function q(a){return a+y.units}function r(){if(""===y.units||"px"===y.units)return 1;var b=a.document.createElement("div");b.style.position="absolute",b.style.top="-100000px",b.style.left="-100000px",b.style.zIndex=-1e5,b.style.width=b.style.height=q(1),a.document.body.appendChild(b);var c=a.getComputedStyle(b).width.replace("px","");return a.document.body.removeChild(b),c}function s(a,b){var c,d=a.origPos,e=t(b);c=m()?"rotate("+b.rotation+" "+e*G+" "+d*G+")":"rotate("+b.rotation+" "+d*G+" "+e*G+")",a.setAttribute("transform",c)}function t(a){var b=n();return b?a.offset:o()-a.offset}var u,v,w="http://www.w3.org/2000/svg",x={width:null,height:null,element:null,layout:"horizontal",alignment:"top",units:"",divisionDefaults:{strokeWidth:1,type:"rect",className:"rulez-rect",renderer:null},textDefaults:{rotation:0,offset:25,className:"rulez-text",showUnits:!1,centerText:!0,renderer:null},divisions:[{pixelGap:5,lineLength:5},{pixelGap:25,lineLength:10},{pixelGap:50,lineLength:15},{pixelGap:100,lineLength:20}],texts:[{pixelGap:100}]},y=p(JSON.parse(JSON.stringify(x)),b),z=2,A=l(),B=[],C=0,D=1;y.width=y.width?y.width:y.element.getBoundingClientRect().width,y.height=y.height?y.height:y.element.getBoundingClientRect().height,y.element.appendChild(A);var E=m()?y.height:y.width,F=0,G=r();this.render=function(){d(),e(u,v),this.scrollTo(0,!1)},this.scrollTo=function(a,b){C=a,b&&(C*=G),m()?A.setAttribute("transform","translate(0,"+-C%(F*G)+")"):A.setAttribute("transform","translate("+-C%(F*G)+",0)");for(var c=C/G,d=0;d<y.texts.length;d++)for(var e=y.texts[d],f=B[d],g=F/e.pixelGap,h=c%F,i=c-h,j=0;j<f.length;j++){var k=f[j],l=Math.floor((i+(j-z*g)*e.pixelGap)*D);e.showUnits&&(l=q(l)),k.textContent=l,e.renderer&&e.renderer(k)}},this.setScale=function(a){D=a,this.scrollTo(C,!1)},this.resize=function(){var a=E,b=m()?y.element.clientHeight:y.element.clientWidth;if(a!==b)if(a>b);else{E=b;var c=v;d(),e(c,v),this.scrollTo(C,!1)}},this.saveAsImage=function(b){var d=c(y.element);d.setAttribute("width",y.width),d.setAttribute("height",y.height);var e=a.document.createElement("canvas");e.setAttribute("width",y.width),e.setAttribute("height",y.height);var f=e.getContext("2d"),g=a.URL||a.webkitURL,h=new Image;h.style.position="absolute",h.style.top="-100000px",h.style.left="-100000px",h.style.zIndex=-1e5,h.setAttribute("width",y.width),h.setAttribute("height",y.height);var i=new Blob([d.outerHTML],{type:"image/svg+xml;charset=utf-8"}),j=g.createObjectURL(i);h.onload=function(){setTimeout(function(){f.drawImage(h,0,0),g.revokeObjectURL(j),a.document.body.removeChild(h),b(e.toDataURL())},1e3)},a.document.body.appendChild(h),h.src=j},this.getUnitConversionRate=function(){return r()}};return b||(a.Rulez=c),c});